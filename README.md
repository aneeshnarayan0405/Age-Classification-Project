# Age Estimation Using Deep Learning

## Overview
This project tackles the task of estimating a personâ€™s age from facial images using deep learning. Instead of formulating the problem as classification into age buckets, we treat it as a **regression task** to predict continuous age. A **ResNet18 model pre-trained on ImageNet** is fine-tuned with a custom regression head to output a single age value.

We used **transfer learning**, **stratified dataset splitting**, **data augmentation**, and evaluation techniques such as **MAE**, **RMSE**, and **confusion matrix (binned by decade)**.

---

## Files Included
- `Age Classification Project for YonderWonder AI Internship.ipynb`: Main Colab-compatible notebook with full code, training, evaluation, and visualizations.
- `assessment_exercise_data.zip`: Dataset containing images grouped into folders based on age.

---

## Key Features
- Regression model using **ResNet18** backbone
- Supports **age prediction from facial images**
- Uses **stratified splitting** to ensure fair evaluation
- Visualizations:
  - Loss curves
  - Scatter plot (True vs Predicted Age)
  - Confusion Matrix (binned to decades)
- Reports **MAE** and **RMSE** for age prediction

---

## Design Decisions
Initially, the problem was tackled as a classification task, but due to poor accuracy caused by small sample sizes in each class, the model was redesigned as a **regression** task. Using a **pretrained ResNet18** allowed us to overcome the challenge of limited data. We also applied **moderate data augmentation** to prevent overfitting and used **stratified sampling** to ensure fair training and validation splits.

---

## Model Architecture
- **Backbone**: ResNet18 pretrained on ImageNet
- **Head**: 128-unit FC layer with ReLU + Dropout + Linear output for regression
- **Loss**: Mean Squared Error (MSE)
- **Optimizer**: Adam with learning rate scheduler

---

## Evaluation
- **MAE**: 36.03 years 
- **RMSE**: 37.18 years 

Confusion matrix is generated by binning predictions and true ages into decades (20s, 30s, etc.). Scatter plot also included for regression overview.

---

## What Worked Well
- Transfer learning (ResNet18)
- Switching to regression
- Stratified splitting
- Basic data augmentation

## What Did Not Work Well
- Classification-based approach (too coarse)
- Deep CNN from scratch (overfitting)
- Very small validation sets

---

## Improvements
- Train for more epochs with early stopping
- Try more aggressive augmentation (CutMix, MixUp)
- Use ResNet34/50 or EfficientNet
- Implement ensemble of regressors
- Add attention-based modules

---

## How to Predict Aging or Rejuvenation
To train a model that can **make a person look older or younger**:

- Use **image-to-image translation** (e.g., CycleGAN, StarGAN)
- Train on dataset with target age as a condition
- Add identity preservation loss
- Use facial landmarks to preserve structure
- Apply data with wide age ranges and consistent lighting

---

## Author
This project was created as part of the YonderWonder ML Research Internship assessment. Designed and developed by Aneesh Narayan Bandaru.
